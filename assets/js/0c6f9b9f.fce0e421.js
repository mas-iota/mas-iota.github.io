"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5606],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(n),g=r,m=u["".concat(s,".").concat(g)]||u[g]||d[g]||o;return n?a.createElement(m,i(i({ref:t},c),{},{components:n})):a.createElement(m,i({ref:t},c))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},9839:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const o={id:"geodata",title:"GeoData",sidebar_label:"GeoData",keywords:["buildfire","geodata","geo","data","geojson","geospatial","geolocation"],slug:"/geodata"},i="GeoData",l={unversionedId:"geodata",id:"geodata",title:"GeoData",description:"GeoData is a service to help developers to manipulate and handle geospatial data properly. Whenever you want to save geospatial data and query operations (nearest location) on it, GeoData is the right way to do it. All methods are accessible in publicData, userData and App Data, but you will need to pay attention to pass the Geospatial Data in the right structure.",source:"@site/docs/Geo-Data.md",sourceDirName:".",slug:"/geodata",permalink:"/docs/geodata",draft:!1,tags:[],version:"current",frontMatter:{id:"geodata",title:"GeoData",sidebar_label:"GeoData",keywords:["buildfire","geodata","geo","data","geojson","geospatial","geolocation"],slug:"/geodata"},sidebar:"api",previous:{title:"Indexed Fields",permalink:"/docs/indexed-fields"},next:{title:"Data Modifying Operators",permalink:"/docs/data-modifying-operators"}},s={},p=[{value:"Inserting Geolocation Data",id:"inserting-geolocation-data",level:2},{value:"Insert Example",id:"insert-example",level:2},{value:"Search Example",id:"search-example",level:2}],c={toc:p};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"geodata"},"GeoData"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"GeoData")," is a service to help developers to manipulate and handle geospatial data properly. Whenever you want to save geospatial data and query operations (nearest location) on it, ",(0,r.kt)("inlineCode",{parentName:"p"},"GeoData")," is the right way to do it. All methods are accessible in ",(0,r.kt)("a",{parentName:"p",href:"/docs/public-data"},(0,r.kt)("inlineCode",{parentName:"a"},"publicData")),", ",(0,r.kt)("a",{parentName:"p",href:"/docs/user-data"},(0,r.kt)("inlineCode",{parentName:"a"},"userData"))," and ",(0,r.kt)("a",{parentName:"p",href:"/docs/app-data"},"App Data"),", but you will need to pay attention to pass the ",(0,r.kt)("strong",{parentName:"p"},"Geospatial Data")," in the right structure."),(0,r.kt)("h2",{id:"inserting-geolocation-data"},"Inserting Geolocation Data"),(0,r.kt)("p",null,"This is the most important part, because the rest will follow like any other type of data. So when you insert the geospatial data you need to put it like the below JSON structure:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "_buildfire": {\n    "geo": {\n      "type": "<GeoJSON type>",\n      "coordinates": ["<longitude>", "<latitude>"]\n    }\n  }\n}\n')),(0,r.kt)("p",null,"Available ",(0,r.kt)("strong",{parentName:"p"},"GeoJSON")," types :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"Point"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"MultiPoint"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"LineString"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"MultiLineString"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"Polygon"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"MultiPolygon"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"GeometryCollection")))),(0,r.kt)("admonition",{title:"important",type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"Please note that we will save whatever data you provide, even if it didn't follow the above JSON structure. This might break the GEO functionality, thus it won't work as expected.")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"insert-example"},"Insert Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'function addNewLocation(location) {\n  buildfire.publicData.insert(location, "places", false, function (err, data) {\n    if (err) console.log("there was a problem saving your data");\n    else console.log("saved successfully");\n  });\n}\n\nvar geoLocation = {\n  _buildfire: {\n    geo: {\n      type: "Point",\n      coordinates: [-73.97, 40.77],\n    },\n  },\n};\n\naddNewLocation(geoLocation);\n')),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"search-example"},"Search Example"),(0,r.kt)("p",null,"The following query uses the ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"$near")," geospatial query operator")," to return documents that are at least 1000 meters from and at most 5000 meters from the specified ",(0,r.kt)("inlineCode",{parentName:"p"},"GeoJSON")," point, sorted in order from nearest to farthest:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'function addNewLocation(location) {\n  buildfire.publicData.insert(location, "places", false, function (err, data) {\n    if (err) alert("there was a problem saving your data");\n    else alert("saved successfully");\n  });\n}\n\nvar place_1 = {\n  _buildfire: {\n    geo: {\n      type: "Point",\n      coordinates: [-73.97, 40.77], //[long,lat]\n    },\n  },\n};\n\nvar place_2 = {\n  _buildfire: {\n    geo: {\n      type: "Point",\n      coordinates: [-73.9928, 40.7193], //[long,lat]\n    },\n  },\n};\n\nvar place_3 = {\n  _buildfire: {\n    geo: {\n      type: "Point",\n      coordinates: [-73.9375, 40.8303], //[long,lat]\n    },\n  },\n};\n\naddNewLocation(place_1);\naddNewLocation(place_2);\naddNewLocation(place_3);\n\n/*\nThe following query uses the $near operator to return documents that are at least 1000 meters from and at most 5000 meters from the specified GeoJSON point\n*/\n\nvar searchUsingNear = {\n  filter: {\n    "_buildfire.geo": {\n      $near: {\n        $geometry: {\n          type: "Point",\n          coordinates: [-73.9667, 40.78], //[long,lat]\n        },\n        $minDistance: 1000,\n        $maxDistance: 5000,\n      },\n    },\n  },\n};\n\n/*\nThis should only returns "Place 1" because the distance between them is 1147 Meters, which is between the min & max distance in filter\n*/\n\nbuildfire.publicData.search(searchUsingNear, "places", function (err, records) {\n  if (err) alert("there was a problem retrieving your data");\n  else {\n    alert("found " + records.length + " record(s)");\n    alert(JSON.strigify(records.length));\n  }\n});\n\n/*\nNOTE:\n  1. Distance between the coordinates in filter and place 1 is "1147 Meters"\n  2. Distance between the coordinates in filter and place 2 is "7101 Meters"\n  3. Distance between the coordinates in filter and place 3 is "6111 Meters"\n*/\n\n/*\nThe following query uses the $geoWithin operator to selects all Places data that exist entirely within a GeoJSON Polygon.\n\nIMPORTANT: Please note that Polygon has to close (the first and last point must be the same).\n*/\n\nvar searchUsingGeoWithin = {\n  filter: {\n    "_buildfire.geo": {\n      $geoWithin: {\n        $geometry: {\n          type: "Polygon",\n          coordinates: [\n            [\n              [-73.9634036, 40.8247236],\n              [-73.9098452, 40.7878222],\n              [-73.9894961, 40.6790779],\n              [-74.046831, 40.7040684],\n              [-73.96342, 40.8247071],\n              [-73.9634036, 40.8247236],\n            ],\n          ],\n        },\n      },\n    },\n  },\n};\n\nbuildfire.publicData.search(\n  searchUsingGeoWithin,\n  "places",\n  function (err, records) {\n    if (err) alert("there was a problem retrieving your data");\n    else {\n      alert("found " + records.length + " record(s)");\n      alert(JSON.strigify(records.length));\n    }\n  }\n);\n\n/*\nThe following query uses the $geoWithin operator to select all Places data that intersect with the Polygon defined by the coordinates array.\n*/\n\nvar searchUsingGeoIntersects = {\n  filter: {\n    "_buildfire.geo": {\n      $geoIntersects: {\n        $geometry: {\n          type: "Polygon",\n          coordinates: [\n            [\n              [-73.9634036, 40.8247236],\n              [-73.9098452, 40.7878222],\n              [-73.9894961, 40.6790779],\n              [-74.046831, 40.7040684],\n              [-73.96342, 40.8247071],\n              [-73.9634036, 40.8247236],\n            ],\n          ],\n        },\n      },\n    },\n  },\n};\n\nbuildfire.publicData.search(\n  searchUsingGeoIntersects,\n  "places",\n  function (err, records) {\n    if (err) alert("there was a problem retrieving your data");\n    else {\n      alert("found " + records.length + " record(s)");\n      alert(JSON.strigify(records.length));\n    }\n  }\n);\n')),(0,r.kt)("admonition",{title:"important",type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"Please note that ",(0,r.kt)("strong",{parentName:"p"},"Polygon")," has to close (the first and last point must be the same).")),(0,r.kt)("p",null,"Available Geospatial query operators:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"$near")),": Returns geospatial objects in proximity to a point."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"$geoWithin")),": Selects geometries within a bounding GeoJSON geometry."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"$geoIntersects")),": Selects geometries that intersect with a GeoJSON geometry"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"$nearSphere")),": Returns geospatial objects in proximity to a point on a sphere.")))}d.isMDXComponent=!0}}]);